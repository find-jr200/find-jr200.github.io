<!DOCTYPE html>
<html>
<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-18578300-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-18578300-4');
</script>
<meta charset="UTF-8">
<meta http-equiv="content-language" content="ja">
<title>JR-200エミュレータ VJR-200</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" media="screen and (max-width:480px)" href="jr_m.css">
<link rel="stylesheet" media="screen and (min-width:481px)" href="jr.css">
<style type="text/css">
.auto-style1 {
	font-size: x-large;
}
.auto-style3 {
	text-align: center;
}
</style>
</head>
<body>
<div class="Main">
<nav>
<a href="index.html"><img src="images/top.png" width="100" height="50" alt="TOP"></a> 
</nav>
	<h1>JR-200エミュレータ　VJR-200 for Windows</h1>
	<p>　JR-200U 用のゲームには動作しないものがあります。詳細は「既知の問題」を参照してください。</p>
	<p>&nbsp; VJR-200 is an emulator of Panasonic JR-200 (Japanese model). 
	However, some of JR-200U software work with VJR-200. English menu and message are available. </p>
	<p>&nbsp; English 
	page is <a href="vjr200_en.html">here</a>.</p>

<p>
<img alt="VJR-200 Image1" height="283" src="images/vjr200title1.png" width="350">&nbsp;　<img alt="VJR-200 Image2" height="283" src="images/vjr200title2.png" width="350"></p>
<nav>
	<p><a href="#dousakakunin">動作確認環境</a><br><a href="#download">Download</a><br>
	<a href="#jyunbihen">準備編</a><br><a href="#kidouhen">起動編</a><br>
	<a href="#FDD">FDD 対応について</a> <strong>NEW</strong><br>
	<a href="#AboutPrintOut">プリンタ出力について</a><br>
	<a href="#AboutTapeFormat">テープフォーマットについて</a><br><a href="#AboutJoystick">ジョイスティックの2ボタン対応について</a><br>
	<a href="#etc">その他</a><br><a href="#knownissue">既知の問題</a><br>
	<a href="#uninstall">アンインストール</a><br><a href="#unimplemented">実装されていない機能</a><br>
	<a href="#bug">バグ報告、動作報告など</a></p>
	<p><strong>マニュアル編は　<a href="vjr200_man.html">こちら</a><br>
	Android 版は　<a href="vjr200android.html">こちら</a></strong></p>
</nav>
	<p>　制作にあたり、Enri さんの解析を最大限利用させていただきました。深く感謝します。また、以下のソフトウェアを使用させて頂きました。</p>
	<p>X88000 (https://quagma.sakura.ne.jp/manuke/x88000.html)<br>Manuke Station</p>
<p>* BSD 三条項ライセンス</p>
	<p>MAME (http://www.mame.net/)<br>copyright-holders: Nicola Salmoria, Aaron 
Giles</p>
	<p>cereal (https://uscilab.github.io/cereal/) <a href="license_cereal.txt">
	LICENSE</a><br>copyright-holders: Randolph 
	Voorhies, Shane Grant</p>
	<p>* Zlib ライセンス</p>
	<p>TinyXML-2　(https://github.com/leethomason/tinyxml2)<br>copyright-holder: 
	Lee Thomason</p>

<h3 id="dousakakunin">動作環境</h3>
	<p>V1.6.1 まで Windows Vista SP2 以降</p>
	<p>V1.7.1 以降　Windows 10 以降</p>
<p>　Windows 10 (22H2) 、Windows 11(22H2) で動作確認。ただし、<strong>Direct2D を使用しているので、Windows XP では動作しません。</strong></p>
<h3 id="download">Download</h3>
	<p>2024.1.3 - Version 1.7.3</p>
	<ul>
		<li>表示倍率に4倍、5倍を追加しました。</li>
		<li>表示の回転機能を追加しました。</li>
	</ul>
	<p>■ Binary</p>
	<p>32bit&nbsp;<a href="https://github.com/find-jr200/VJR200forWindows/releases/download/V1.7.2/VJR200_172_win32.zip">https://github.com/find-jr200/VJR200forWindows/releases/download/V1.7.3/VJR200_173_win32.zip</a>&nbsp; 
	(212KB)</p>
	<p>64bit&nbsp;<a href="https://github.com/find-jr200/VJR200forWindows/releases/download/V1.7.2/VJR200_172_win64.zip">https://github.com/find-jr200/VJR200forWindows/releases/download/V1.7.3/VJR200_173_win64.zip</a>&nbsp; 
	(239KB)</p>
<p><strong>※　このプログラムは十分な検証がされていません。ユーザー環境に有害な影響を与えるようなことはしていないつもりですが、いかなる損害が生じても当方は一切補償しません。了解の上ご利用下さい。</strong></p>
	<p>　ダウンロードした VJR-200 を実行しようとすると「Windows によって PC 
	が保護されました。」「実行しない」と表示されます。これは実行プログラムに署名がないせいらしいのだが、署名をつけるための諸々をする気はないので、ここは信用してもらって「詳細情報」－「実行」を選んでもらうしかありません。</p>
	<p>　それがイヤな人は下のソースコードをダウンロードして、ウィルスがいないことを確認して自分でビルドしてどうぞ。</p>
	<p>■ Source code</p>
	<p><a href="https://github.com/find-jr200/VJR200forWindows">
	find-jr200/VJR200forWindows (github.com)</a></p>
	<p>Version 1.6.1 までは Visual Studio 2015 Community、1.7.1 以降は Visula studio 
	2022 Community でビルドできます。1.3.1 からは cereal 
	というライブラリが必要です。cereal (<a href="https://uscilab.github.io/cereal/">https://uscilab.github.io/cereal/</a>) 
	から V 1.2.2 をダウンロード、展開し、Visual Studio のインクルード・ディレクトリに cereal-1.2.2\include\ 
	を追加してください。</p>
	<p>ソースコードに関する注意点と言い訳</p>
	<ul>
		<li>使わせてもらった MAME のソースが BSD 3条項ライセンスというものなので、私が書いた部分も 
BSD 3条項ライセンスで配布します（←あんまりよくわかってない）。</li>
		<li>文字型に TCHAR を使ってますが、マルチバイトにしても動きません。じゃあなぜ TCHAR 
		にしたかと言うと、書き始めた当初はどっちがいいかわからなかったからです。</li>
		<li>私は仕事で C/C++ を使うわけではないので、素人みたいなもんです。間違ってもこのソースを見て C/C++ 
		の勉強をしようとか、エミュレータの勉強をしようなんて思わないでください。つーか、ほかの人が書いたエミュレータのソースは今回使わせてもらった部分以外ほぼ見たことがないので、とんでもなく非効率だったり、糞な実装もあるでしょう。</li>
	</ul>
	<p><a href="vjr200_history.html">過去の更新履歴とダウンロード</a></p>
<h2 id="jyunbihen">準備編</h2>
<p>1. 実機からROMとフォントを吸い出します。<br></p>
<p>MSAVE "ROM1",$A000,$BFFF　　　　（ファイルサイズ　8192byte）<br>
MSAVE "ROM2",$E000,$FFFF　　　　（ファイルサイズ　8192byte）<br>
MSAVE "FONT",$D000,$D7FF　　　　（ファイルサイズ　2048byte）</p>
	<p>FDD システムがある場合は</p>
	<p>MSAVE "CAS1:FDDROM",$D800,$DFFF　　　　（ファイルサイズ　2048byte）</p>
<p>　として（ファイル名は任意）WAV ファイルに保存し、JR2Rescue を使用して BIN ファイルに変換してください（CJR はダメ）。</p>
<p>　ファイルサイズが正しいか確認してください。ファイルサイズをチェックしているので正しくないと登録できません。</p>
<p>2. ROM ファイルを結合します。</p>
<p>COPY /B ROM1.BIN+ROM2.BIN ROM.BIN</p>
<p>　として一つにまとめてください（ファイル名は任意）。結合する順番が逆だと動作しないので気を付けて。結合後のファイルサイズは16384 byte になっているはずなので確認してください。</p>
<p>3. Visual C++ 再頒布可能パッケージが必要です。</p>
	<p>vjr200.exe を起動してインストールを求められた場合は、</p>
	<p>Microsoft Visual C++再頒布可能な最新のサポートされているダウンロード<br>
	<a href="https://learn.microsoft.com/ja-jp/cpp/windows/latest-supported-vc-redist?view=msvc-170">
	https://learn.microsoft.com/ja-jp/cpp/windows/latest-supported-vc-redist?view=msvc-170</a></p>
<p>から Visual Studio 2015、2017、2019、および 2022用をダウンロードしインストールしてください。</p>
	<p>ダウンロード直リンク</p>
	<p>32bit <a href="https://aka.ms/vs/17/release/vc_redist.x86.exe">https://aka.ms/vs/17/release/vc_redist.x86.exe</a></p>
	<p>64bit <a href="https://aka.ms/vs/17/release/vc_redist.x64.exe">
	https://aka.ms/vs/17/release/vc_redist.x64.exe</a></p>
	<p>　Version 1.7.1 から 32, 64bit 両バージョン公開しています。<strong>OS ではなく VJR-200 
	のどちらのバージョンを使うかに合わせて</strong>ライタイムをインストールしてください。</p>

<h2 id="kidouhen">起動編</h2>
<p>1. vjr200_xxx.zip を解凍し、VJR200.exe、VJR200_jp.dll、VJR200_en.dll を<strong>同じフォルダに</strong>置いてください。<strong>日本語しか使わない場合でも 
VJR200_jp.dll は必要です。VJR200.exe だけでは動作しません</strong>。</p>
	<p>VJR200.exe　　実行ファイル<br>VJR200_jp.dll　　日本語リソースファイル<br>
	VJR200_en.dll　　英語リソースファイル</p>
	<p>　Program Files 以下にフォルダを作ってもいいですが、それ以外の方がいいのかもしれない。ちなみに設定ファイルはユーザーフォルダの AppData&yen;local&yen;FIND_JR&yen;VJR-200&yen; 以下に置かれます。</p>
<p>2. 最初に起動すると、ROM ファイルとフォントファイルが設定されていないのでこの画面になります。</p>
	<p><img alt="" height="311" src="images/init.png" width="400"></p>
<p>3. [ツール]-[ROM、フォントファイルの設定]ダイアログでそれぞれのファイルを設定して VJR-200 を一度終了し、再実行してください。</p>
	<p>4. 無事JR-200 の起動画面が出たら、あとはお好きなように。各機能については<a href="vjr200_man.html">マニュアル編</a>へ。</p>
<h3 id="FDD">FDD 対応について</h3>
	<p>　Version 1.6.1 から FDD に対応しました。この機能を使用するためには上記の通り拡張 ROM 部分を吸い出し、DISK BASIC 
	のシステムディスクを D88 フォーマットでイメージファイル化する必要があります。D88 
	化の方法については各自で考えてください。ディスクイメージファイルの拡張子は "D20" です。</p>
	<p>　FDD 対応 ROM を登録した状態で VJR-200 を起動すると真っ黒な画面で止まります。FDD - 
	ディスクイメージのメニューでシステムディスクのイメージをマウントし、リセットすると FD を読み込み DISK BASIC が起動します。</p>
	<p>　ステータスバーには左からマウントされているテープのファイル名、ドライブ1、ドライブ2のイメージ名が表示されます。</p>
	<h3>プリンタ出力について</h3>
	<p>　Version 1.1.1 からプリンタ出力に PNG 
	フォーマットを追加しました。テキスト出力と異なりグラフ文字も出力でき、LPRINT を使ってユーザー定義文字も出力できます。PNG 
	を選択するとピクチャーフォルダに "JR200Print001.png"&nbsp; から "JR200Print999.png" まで連番で出力し、1000になるとエラーになります（多分）。</p>
	<p>
	　メニューバーには「プリンタ・データ受信ランプ」を追加し、データ受信中に点灯するとともに、出力フォーマットがわかるようにしました。データ受信中はキーボードに触れたり、エミュレータを操作しない方が身のためです。</p>
	<p><img alt="" height="64" src="images/printer_data.png" width="322"></p>
	<p>　さらに RAW 出力の際のファイル名を変更しました。それぞれのファイル名は以下のようになります。</p>
	<p>テキスト　printout.txt　（ドキュメント フォルダ）<br>RAW　JR200Print.bin　（ドキュメント フォルダ）<br>
	PNG　JR200Print001.png　（ピクチャ フォルダ）</p>
	<p>　さて、PNG では今までのテキスト出力と異なりどうしてもページ単位の処理となるため、ラインプリンタ前提の ESC/P 
	では「どこでページ送り（＝画像を出力）するのか」という問題があります。</p>
	<p>　なのでデフォルトでは 500ms 
	データが来ないと出力終了と判断してページ送りしますが、それでは問題が起きる場合や、1枚の画像にハードコピーとリストをまとめたいといった場合は、[オプション]－[プリンタ]にある「自動ページ送り」のチェックを外してください。</p>
	<p>　ただしページ送りを手動にするとページがいっぱいにならない限り出力されないので、出力したいタイミングで[ファイル]－[プリンタ 
	ページ送り]を実行してください。これを忘れると「出力されない！バグだ！」と騒ぐことになるので注意。</p>
	<p>　ちなみにプリンタは80桁固定です。JR-BASIC の一行あたりの文字数が80字までなので、これで問題ないでしょう。</p>
	<p>■　使用上の注意　■</p>
	<p>　データ受信中に出力先を切り替えるような無謀なことはしないでください。<strong>何が起きるかわかりません</strong>。切り替えは必ずデータ受信ランプが消えた状態で。</p>
	<p>　ESC/P については JR-200 が出力する最低限のコードしか処理していません。ユーザープログラムで直接 ESC/P 
	コードを送って高度な印刷を実現しようなんて思わないでください。<strong>どんな恐ろしいことが起きても知りません</strong>。PNG 
	出力で対応しているのは、LLIST, LPRINT, ハードコピーのみです。</p>
	<p>　テキスト出力時にグラフ文字のキャラクターコードが出力されないのは仕様です。</p>
	<h3 id="AboutTapeFormat">テープフォーマットについて</h3>
	<p>　Version 0.7.1 から新しいフォーマット、JR2形式を追加しました。これに伴い SAVE, LOAD 
	時の動作が若干複雑になっています。</p>
	<table>
		<tr>
			<th style="width: 15%"></th>
			<th style="width: 25%">SAVE</th>
			<th style="width: 10%">LOAD</th>
			<th style="width: 25%">PRINT#</th>
			<th style="width: 25%">INPUT#</th>
		</tr>
		<tr>
			<th style="width: 15%">マウントしてない</th>
			<td style="width: 25%">CJRに書き出し</td>
			<td style="width: 10%">NA</td>
			<td style="width: 25%">不正なsave?.cjrが作られる</td>
			<td style="width: 25%">NA</td>
		</tr>
		<tr>
			<th style="width: 15%">CJR をマウント</th>
			<td style="width: 25%">CJRに書き出し<br>ただしマウントしているものとは別のCJRファイルになる</td>
			<td style="width: 10%">CJRをロード</td>
			<td style="width: 25%">不正なsave?.cjrが作られる</td>
			<td style="width: 25%">多分エラー</td>
		</tr>
		<tr>
			<th style="width: 15%">JR2 をマウント</th>
			<td style="width: 25%">JR2に書き出し<br>常にマウントされたファイルの最後に追記される</td>
			<td style="width: 10%">JR2をロード</td>
			<td style="width: 25%">
			「録音停止時、ブランクを付加する」をチェックした場合のみ、読み込み可能な形式で記録</td>
			<td style="width: 25%">
			「録音停止時、ブランクを付加する」をチェックして記録したもののみ正常読み込み</td>
		</tr>
	</table>
	<p>JR2 フォーマットの詳細については以下のページを参照してください。</p>
	<p><a href="aboutjr2format.html"><span lang="en-US">JR2(JR-200 Raw)</span><span lang="ja">フォーマットについて</span></a></p>
	<p><strong>※　JR2 フォーマットはまだ初期実装です。問題が見つかって仕様変更する可能性もあるので、大切なプログラムやデータは JR2 
	フォーマットのみで保存しないでください。</strong></p>
<h3 id="AboutJoystick">ジョイスティックの2ボタン対応について</h3>
	<p>　Version 0.6.1 からジョイスティックの2ボタンに対応しました。JR-200 
	の純正・推奨品のジョイスティックは1ボタンだったと思われますが、実はジョイスティック端子と ROM 
	コードは2ボタンに対応しています。端子の割り当ては MSX と同様。</p>
	<p><img alt="" height="165" src="images/joy_con.png" width="250"></p>
	<p>　ソフト的には STICK(1), STICK(2) で帰ってくる1バイトの値。</p>
	<table style="width:50%;">
		<tr>
			<td class="auto-style3">１</td>
			<td class="auto-style3">１</td>
			<td class="auto-style3">0</td>
			<td class="auto-style3">0</td>
			<td class="auto-style3">１</td>
			<td class="auto-style3">１</td>
			<td class="auto-style3">１</td>
			<td class="auto-style3">１</td>
		</tr>
		<tr>
			<td class="auto-style3">&nbsp;</td>
			<td class="auto-style3">&nbsp;</td>
			<td class="auto-style3">B</td>
			<td class="auto-style3">A</td>
			<td class="auto-style3">右</td>
			<td class="auto-style3">左</td>
			<td class="auto-style3">下</td>
			<td class="auto-style3">上</td>
		</tr>
	</table>
	<p>　となっています。A が押されれば5ビット目が０に、B が押されれば6ビット目が０になります。純正・推奨品のボタンはおそらく A 
	のみ接続されているんじゃないかと思われます（持ってないので100%推測）。</p>
	<p>　というわけで、VJR-200 の[オプション]-[ジョイパッド]で2ボタンを有効にし、A, B 
	に適当なボタンを割り当て、さらに2ボタンに対応したゲームを作ればボタンの数だけはファミコン、MSX に負けない？ゲームが作れるわけですが、<strong>だがちょっと待ってほしい</strong>。</p>
	<p>　最大の問題は、そのプログラムは実機で動かせるのかという問題。これは非常に重要なことなので声を大にして言いますが、</p>
	<p class="auto-style1"><strong>
	JR-200実機に純正・推奨品以外のジョイスティックを接続すると最悪、本体を破壊する恐れがあります。</strong></p>
	<p>　なぜそうなるのかを知りたい人は、Enri さんの JR-200 
	解析ページを参照させてもらってください。とにかくこれは大変危険な行為なので、とてもじゃないが人に勧められない。しかし純正品は多分2ボタンに対応してない。唯一の道は自己責任で他機種用の2ボタンのジョイスティックを改造すること。</p>
	<p>　というわけで、実機で2ボタン対応ソフトを実行するハードルは非常に高い。それでも2ボタン対応ソフトを作って公開しようという人は、実機に他機種用2ボタン対応ジョイパッドを接続することのリスクを明記してください。私は何が起きても一切責任取りません。</p>
	<p>
	　それともう一つ、上記の問題に比べれば些細なことですが、なんせ2ボタン対応純正・推奨品がないので、2つのボタンの配置をどう想定するか。まあこれはファミコン・MSX 
	と同様にするほかないだろう</p>
	<p>
	　と思ってもう一度確認したら、パナソニック（右から A, B）とソニー（左から1, 2）でボタンの表記が違うんだけど。MSX 
	ってジョイパッドのボタン配置と表記が統一されてなかったの？　これじゃゲーム作る人困っちゃうやん。まあいいわ、VJR-200 
	はファミコン、パナソニック方式に従います。</p>
	<p><strong>※　2ボタン対応プログラムを作成する場合は、右側を A（6番ピン）、左側を B（7番ピン）として作成してください。</strong></p>
<h3 id="etc">その他</h3>
	<ul>
		<li>ジョイスティックに対応しています。OS がジョイスティックを認識している状態で VJR-200 を起動すれば使用することができます。</li>
		<li>SAVE、MSAVE 
	が使用できます。ドキュメントフォルダにsave???.cjr（連番）で書き出します。999を超えるとエラーになる（つもりで）作ったのであまりため込みすぎないように。ただし記録方法が微妙に違うため 
		CJR ファイルに対して 
	PRINT# は正常動作しません。<br>　なお、このSAVE でできたファイルと JR2Rescue のメモリダンプ→CJR 化や、VJR-200 の CJR 
	保存機能を使って作ったファイルを比べると、同じ内容のプログラムでもバイナリ一致しないことがあります。これはどうも私が作った CJR 
	化プログラムが1バイト多く保存してしまうことがあることから起きるらしい。多分実害はないと思いますが（1バイト無駄にするくらい）、気になる人は、この純正 
	SAVE を使ってください。</li>
		<li>動画キャプチャには Windows 10 のゲーム録画機能が利用できます。したがって VJR-200 
		内に動画キャプチャ機能を実装する予定はありません。</li>
	</ul>

<h3 id="knownissue">既知の問題</h3>
	<p>　キーボードフックする常駐ソフトを使っていると、ゲームなどでキー入力出来なくなることがあります（通常時のキー入力はできる）。JR BASIC の 
	PICK やSTICK を使うと巡り巡って Windows API の GetKeyboardState() という API 
	を呼び出すことになりますが、これを高速で繰り返し呼び出しまくると問題が起きるらしい。</p>
	<p>
	　この現象が起きる場合は入力モードを英数、カナ、GRAPH など切り替えながら適当に入力して Return を押し、わざと Syntax error 
	を起こすことを数回繰り返すと直ることがあります。それでもだめなら 
	Windows を再起動してください。</p>
	<p>
	　さらに MN1271 の実装はかなりいい加減。ゲーム動きゃいいだろ？レベル。詳細な資料がないのでどうしようもない。</p>
	<h4>
	JR-200U 用ゲームについて</h4>
	<p>
	JR-200U 用のゲームには動作しないものが多数あります。一応の動作を確認しているものは、</p>
	<p>
	COSMIC PATROL, CRAZY MAZY, MARS CARS, PHASER COMMAND, RAM ROM PATROL, SOLITAIRE, 
	SWASHBUCKLER, VOLTEX</p>
	<p>
	だけです。これ以外のゲームはロードできないか、実行時に問題があります。&nbsp;</p>
	<h3 id="uninstall">アンインストール</h3>
<p>　VJR200.exe、VJR200_jp.dll、VJR200_en.dll を削除し、ユーザーフォルダの AppData&yen;Local にある、&yen;FIND_JR&yen; 以下を削除してください。</p>


	<h3 id="unimplemented">実装されていない機能</h3>
	<p>プリンタ実機への出力　→　純正プリンタも ESC/P プリンタも持ってないので無理</p>
	<p>周辺機器（RS-232C<del>, FDD</del>）　→　持ってないので無理</p>
<h3 id="bug">バグ報告、動作報告など</h3>
<p>
　バグ報告、動作報告などは掲示板、またはメールでお待ちしています。メールアドレスはトップページの一番下にあります。なお、機能拡張の要望にはあまり応じられないと思ってください。ソースコードを公開しているので自由に改変してください。フルHD フルカラー、PCM 
64ch音源のJR-200を作ってもよし。</p>

<hr>
<p style="text-align:center">［<a href="index.html">TOP PAGE</a>］</p>
</div>
</body>
</html>
